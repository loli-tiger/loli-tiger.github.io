<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Three.js Demo</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden;
            font-family: Arial, sans-serif;
            background: #222;
        }
        #stats-container {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            z-index: 10;
            text-align: center;
        }
        #reset-btn {
            position: fixed;
            top: 40px;
            left: 10px;
            padding: 8px 15px;
            z-index: 100;
            background: #444;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        #reset-btn:hover {
            background: #666;
        }
    </style>
</head>
<body>
    <div id="loading">初始化Three.js场景...</div>
    <div id="stats-container"></div>
    <button id="reset-btn">重置视角</button>
    
    <!-- 使用固定版本的库 -->
    <script src="https://cdn.jsdelivr.net/npm/stats.js@0.17.0/build/stats.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.162.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.162.0/examples/js/controls/OrbitControls.min.js"></script>
    
    <script>
        // 确保所有依赖加载完成
        window.addEventListener('load', () => {
            // 检查所有依赖是否已加载
            function checkDependencies() {
                if (typeof THREE !== 'undefined' && 
                    typeof Stats !== 'undefined' && 
                    typeof THREE.OrbitControls !== 'undefined') {
                    
                    // 加载应用逻辑
                    const script = document.createElement('script');
                    script.src = 'app.js';
                    script.onload = () => {
                        document.getElementById('loading').textContent = '启动场景...';
                        // 延迟启动确保所有资源就绪
                        setTimeout(() => {
                            initApp(THREE, Stats, THREE.OrbitControls);
                            document.getElementById('loading').style.display = 'none';
                        }, 100);
                    };
                    document.body.appendChild(script);
                } else {
                    setTimeout(checkDependencies, 50);
                }
            }
            
            checkDependencies();
        });
    </script>
</body>
</html>
